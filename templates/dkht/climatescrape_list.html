{% extends "dkht/base.html" %}
{% load static %}
{% block content %}
{{ block.super }}
<div id="background-image">
    <div class="row">
        <div class="col s12">
          <h3>Canadian Climate Data Wrangler</h3>
        	  <h5>Search and Acquire Climate Data</h5>
            <p class="subheader flow-text">In the process of developing this application,
              I realized I had to place a few restrictions on the search to avoid some risk of racking up large server charges.</p>
            <p class="subheader flow-text">For this reason, the largest search radius is set to 40km.
              If you'd like a custom query, either for a larger search area, for hourly climate data,
              or for any other large data manipulation tasks, feel free to <a href="{% url 'dkht:contact-view' %}">contact me</a>,
              or reach out to me through the LinkedIn, Github, or Google+ links in the footer.</p>
            <h4>Results</h4>
          {% if stations %}
             <table class="highlight">
               <thead>
                 <tr>
                   <th>Station Name</th>
                   <th>Station ID</th>
                   <th>Lat/Lon [dec. degrees]</th>
                   <th>Distance to Target [km]</th>
                   <th>Record Start Year</th>
                   <th>Record End Year</th>
                   <th>Download [daily]</th>
                 </tr>
               </thead>
               <tbody>
                 {% for station in stations %}
                  <tr>
                    <td>{{ station.station_name }}</td>
                    <td>{{ station.station_ID }}</td>
                    <td>{{ station.latlon }}</td>
                    <td>{{ station.distance_to_target|floatformat:1 }}</td>
                    <td>{{ station.start_year }}</td>
                    <td>{{ station.end_year }}</td>

                    <td><a href="{% url 'dkht:climate-scrape-export' station_ID=station.station_ID start_year=station.start_year end_year=station.end_year %}">

                      <i class="material-icons">cloud_download</i>
                    </a></td>
                  </tr>
                 {% endfor %}
               </tbody>
            </table>
            {% else %}
              <p class="subheader">No stations found.  Try a larger search radius or another location.</p>
            {% endif %}
        </div>
    </div>
    <div class="row">
      <div class="col s12 left">
        <p class="flow-text">If you found this tool helpful and it's saved you some time, consider making a donation!</p>
        <form action="/checkout" method="POST">
            <script src="https://checkout.stripe.com/checkout.js"
                class="stripe-button"
                data-key="{{ stripe_key }}"
                data-amount="2000"
                data-name="Climate Data Wrangler"
                data-description="Support for the Climate Data Wrangler Tool"
                data-image="{% static 'images/dkhydrotech_green.jpg' %}"
                data-currency="cdn">
            </script>
        </form>
        <p class="flow-text">Payment is processed securely through <a href="https://stripe.com/ca">Stripe</a></p>
      </div>
      <div class="col s12">
        <p class="subheader">The Canadian Climate Data Wrangler tool retrieves and concatenates data collected, reviewed, and published by <a href="http://climate.weather.gc.ca/">Environment Canada</a>.  The author of this software does not guarantee the accuracy of any data, and this application is provided WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the <a href="http://www.gnu.org/licenses/">GNU General Public License</a> for more details.</p>
      </div>
    </div>
</div>
    <!--{# {% render_bundle 'vendors' %}#}
    {# {% render_bundle 'App1' %}  #} -->
{% endblock content %}
